<script type="text/ng-template" id="reports_renderer.html">
  <div nodrag>
    <a ng-class="{{ report.msg.QualityEst.MOSCQ > 3 }} ? 'btn btn-success btn-xs' : 'btn btn-warning btn-xs'" nodrag ng-click="toggleTree(report.id)">
	{{ report.msg.QualityEst.MOSCQ ? report.msg.QualityEst.MOSCQ : '' }}
    <span class="glyphicon"
        ng-class="{
          'glyphicon-chevron-right': !collapsed[report.id],
          'glyphicon-chevron-down': collapsed[report.id]
        }"></span></a>
    {{report.date}}: [{{report.correlation_id}}]
  </div>
  <ol ng-model="report.msg" ng-class="{hidden: !collapsed[report.id]}" nodrag>
    <li ng-repeat="(property, value) in report.msg">
      <div class="tree-report tree-report-content" nodrag> {{property}}:</div>
	  <ol  ng-model="value" nodrag>
		<li ng-repeat="(p, v) in value">{{p}}: {{v}}</li>
	  </ol>                 
    </li>
  </ol>
</script>

<script type="text/ng-template" id="logs_renderer.html">
  <div nodrag>
    <a class="btn btn-success btn-xs" nodrag ng-click="toggleTree(log.id)">
    <span class="glyphicon"
        ng-class="{
          'glyphicon-chevron-right': !collapsed[log.id],
          'glyphicon-chevron-down': collapsed[log.id]
        }"></span></a>
    {{log.date}}: [{{log.correlation_id}}]
  </div>
  <ol ng-model="log.msg" ng-class="{hidden: collapsed[log.id]}" nodrag>
        {{log.msg}}
  </ol>
</script>


<div class="modal-header homer-modal-header" style="border-bottom:0;" >
	<button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="closeModal()" style="margin-right:4px;">&times;</button>

        	<h4 class="modal-title" style="font-size:15px;margin-left:4px;margin-bottom:10px;"><i class="fa fa-phone" style="margin-right:5px;"></i> Call-ID: <i> {{msgCallId}} </i></h4> 
</div>
<div ng-show="dataLoading">
	<div id="loadingWidget" class="row-fluid ui-corner-all" style="padding: 0 .7em;">
		<i class="fa fa-asterisk fa-spin"></i>
        	<div class="loadingContent"><p><img alt="Loading  Content" src="img/ajax-loader.gif" /> Loading</p></div>
        </div>
</div>

<div class="modal-body homer-modal-body">
		<div class="modal-body-buttons">

	<tabset>
	     <tab>
	     <tab-heading><i class="fa fa-exchange"></i> Call-Flow </tab-heading>	     	     
	      <canvas id="cflowcanv" class="cflow" canvasclick style="left:15px;"></canvas>
	     </tab>
	     <tab>
	     <tab-heading><i class="fa fa-rss"></i> QoS Reports </tab-heading>	     	     
			<div id="no-reports" ng-hide="enableQualityReport|| enableXRTPReport || enableRTCPReport" class="alert alert-warning alert-dismissible" role="alert">
				 <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				  <strong>Sorry!</strong> No Reports available for this session
			</div>

			<div id="tree-root" ng-if="enableQualityReport" class="jumbotron" style="padding:8px;margin:5px;">				
				<p>RTCP-XR VQ:</p>
				<ol ng-model="qualityreport">
					<li ng-repeat="report in qualityreport" ng-include="'reports_renderer.html'"></li>
				</ol>
			</div>				

			<div id="xrtp-root" ng-if="enableXRTPReport" class="jumbotron" style="padding:8px;margin:5px;">				
				<p>X-RTP:</p>
				<ol ng-model="xrtpreport">
					<li ng-repeat="report in xrtpreport">
						<div>
						    <a class="btn btn-default btn-xs" nodrag ng-click="toggleTree(report.id)">
							<i class="fa fa-flag"></i>
						    <span class="glyphicon" ng-class="{'glyphicon-chevron-right': !collapsed[report.id], 'glyphicon-chevron-down': collapsed[report.id]}"></span></a>
						    {{report.date}}: Method:[{{report.method}}] Source: [{{report.source}}]
						</div>
						<ol ng-model="report.report" ng-class="{hidden: !collapsed[report.id]}" nodrag>
						    Source IP: {{report.source}}
						    <li ng-repeat="(property, value) in report.report">{{property}}: {{value}}</li>
						</ol>															
					</li>
				</ol>
			</div>				
			
			<div id="rtcp-root" ng-if="enableRTCPReport" class="jumbotron" style="padding:8px;margin:5px;">				
				<p>RTCP:</p>
				<ol ng-model="rtcpreport">
					<li ng-repeat="report in rtcpreport" ng-include="'reports_renderer.html'"></li>
				</ol>
			</div>							
									
	     </tab>	     
	     <tab>
	     <tab-heading><i class="fa fa-file-text-o"></i> Logs </tab-heading>	     	     
			<div id="no-reports" ng-hide="enableLogReport" class="alert alert-warning alert-dismissible" role="alert">
				 <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				  <strong>Sorry!</strong> No Logs available for this session
			</div>
			<div id="log-root" ng-if="enableLogReport" class="jumbotron" style="padding:8px;margin:5px;">				
				<p>SysLog from {{ logreport[0].source_ip }}:{{logreport[0].source_port}}</p>
					<table border=0 cellpadding="0" style="margin:5px;margin-left:45px;">
					<tbody style="text-indent:-40px;padding-left:40px;">
					  <tr ng-repeat="log in logreport" >
					    <td style="white-space: normal;">{{ log.msg }}</td>
					  </tr>
					</tbody>
					</table>

			<!--	
				<ol ng-model="logreport">
					<li ng-repeat="log in logreport" ng-include="'logs_renderer.html'"></li>
				</ol>
   			-->
			</div>				


	     </tab>
	     <tab>
	     <tab-heading><i class="fa fa-cloud"></i> Export</tab-heading>
			<div style="margin:15px;">
			<button class="btn btn-normal" ng-click="exportPCAP()" data-placement="top-right" style="margin-top:18px;;margin-left:8px;"><i class="fa fa-cloud-download"></i><br>  Export PCAP</button>
			<button class="btn btn-normal" ng-click="exportTEXT()" data-placement="top-right" style="margin-top:18px;;margin-left:8px;"><i class="fa fa-file-text-o"></i><br> Export TEXT</button>
			<button class="btn btn-normal" ng-click="exportCanvas()" data-placement="top-right" style="margin-top:18px;margin-left:8px;"><i class="fa fa-file-image-o"></i><br> Export PNG</button>			
			<button class="btn btn-normal" ng-click="exportShare()" data-placement="top-right" style="margin-top:18px;;margin-left:8px;"><i class="fa fa-share-alt"></i><br> Share Link</button>
			<br><br>
			<p>
			{{sharelink}}
			</p>
			</div>
	     </tab>
	  </tabset>
</div>
